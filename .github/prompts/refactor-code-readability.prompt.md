How can I improve the readability of this code? (e.g., "How can I refactor this C# function to be more maintainable?)